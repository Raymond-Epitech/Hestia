import{T as M}from"./Cy9Qc-Zf.js";import{d as R,a5 as $,u as q,a as D,J as j,r as T,i as z,t as o,v as u,x as s,z as d,Q as p,N as g,R as y,O as l,a6 as w,X as m,Y as v,y as _,B as x,a7 as A,P as J}from"./k0LMFOWj.js";import{_ as L}from"./C0cpsfxA.js";import{u as Q}from"./CEvMXAWB.js";const X={class:"background"},Y={class:"header"},G={method:"post",action:""},H=["value"],K=["value"],W={key:0},Z={class:"checkbox-list"},ee=["value"],te=["value"],se={key:1},le={class:"checkbox-list"},ne=["value"],ae=["onUpdate:modelValue"],oe={key:2},ue={class:"checkbox-list"},ie=["value"],re=["onUpdate:modelValue"],de=["value"],pe={class:"modal-buttons"},he=R({__name:"addExpense",setup(ce){var B;const k=Q().user,P=$(),U=q(),f=P.query.name,{$bridge:S}=D(),b=S;b.setjwt(j("token").value??"");const V=new Date,h=k.colocationId,N=k.id,r=T([]),I=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],t=T({colocationId:h,createdBy:"",description:"",category:f,name:"",amount:0,paidBy:((B=r.value[0])==null?void 0:B.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:V.toISOString()});b.getUserbyCollocId(h).then(a=>{var n;r.value=a,Object.assign(t.value,{colocationId:h,createdBy:N,description:"",category:f,name:"",amount:0,paidBy:((n=r.value[0])==null?void 0:n.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:V.toISOString()})}).catch(a=>{console.error("Error fetching data:",a)});const C=a=>((t.value.splitPercentages[a]||0)/100*t.value.amount).toFixed(2),E=z(()=>{const a=t.value.splitBetween.length;return a>0?(t.value.amount/a).toFixed(2):0}),F=async()=>{console.log(t.value),b.addExpense(t.value).then(()=>{console.log("Expense added successfully"),U.back()}).catch(a=>{console.error("Error adding expense:",a)})},O=a=>{const n=a.target,i=n.value,e=i.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");e!==i&&(n.value=e),isNaN(parseFloat(e))?t.value.amount=0:t.value.amount=parseFloat(e)};return(a,n)=>{const i=M;return u(),o("div",X,[s("div",null,[s("h1",Y,[s("img",{src:L,alt:"Return",width:"30",height:"30",onClick:n[0]||(n[0]=e=>a.$router.back())}),d(i,{source:"header_add_expense"}),n[6]||(n[6]=s("p",null,null,-1))])]),s("form",G,[s("div",null,[s("h3",null,[d(i,{source:"expense_name"})]),p(s("input",{class:"body-input",rows:"3","onUpdate:modelValue":n[1]||(n[1]=e=>l(t).name=e),required:""},null,512),[[y,l(t).name]]),s("h3",null,[d(i,{source:"expense_amount"})]),p(s("input",{class:"body-input",type:"number","onUpdate:modelValue":n[2]||(n[2]=e=>l(t).amount=e),placeholder:"0.00",onInput:O,min:"0",required:""},null,544),[[y,l(t).amount]]),s("h3",null,[d(i,{source:"expense_paid_by"})]),p(s("select",{"onUpdate:modelValue":n[3]||(n[3]=e=>l(t).paidBy=e),class:"body-input"},[(u(!0),o(m,null,v(l(r),e=>(u(),o("option",{key:e.id,value:e.id},_(e.username),9,H))),128))],512),[[w,l(t).paidBy]]),s("h3",null,[d(i,{source:"split_type"})]),p(s("select",{"onUpdate:modelValue":n[4]||(n[4]=e=>l(t).splitType=e),class:"body-input"},[(u(),o(m,null,v(I,e=>s("option",{key:e.value,value:e.value},[d(i,{source:e.label},null,8,["source"])],8,K)),64))],512),[[w,l(t).splitType]]),l(t).splitType==0?(u(),o("div",W,[s("div",Z,[(u(!0),o(m,null,v(l(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[p(s("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":n[5]||(n[5]=c=>l(t).splitBetween=c)},null,8,ee),[[A,l(t).splitBetween]]),x(" "+_(e.username)+" ",1),s("input",{type:"number",class:"split-value-input",value:l(t).splitBetween.includes(e.id)?l(E):0,readonly:""},null,8,te)]))),128))])])):g("",!0),l(t).splitType==1?(u(),o("div",se,[s("div",le,[(u(!0),o(m,null,v(l(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[s("input",{type:"checkbox",value:e.id},null,8,ne),x(" "+_(e.username)+" ",1),p(s("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>l(t).splitValues[e.id]=c,placeholder:"0.00",min:"0"},null,8,ae),[[y,l(t).splitValues[e.id],void 0,{number:!0}]])]))),128))])])):g("",!0),l(t).splitType==2?(u(),o("div",oe,[s("div",ue,[(u(!0),o(m,null,v(l(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[s("input",{type:"checkbox",value:e.id},null,8,ie),x(" "+_(e.username)+" ",1),p(s("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>l(t).splitPercentages[e.id]=c,placeholder:"0",min:"0",max:"100"},null,8,re),[[y,l(t).splitPercentages[e.id],void 0,{number:!0}]]),s("input",{type:"number",class:"split-value-input",value:C(e.id),readonly:""},null,8,de)]))),128))])])):g("",!0)]),s("div",pe,[s("button",{class:"button button-proceed",onClick:J(F,["prevent"])},[d(i,{source:"poster"})])])])])}}});export{he as default};
