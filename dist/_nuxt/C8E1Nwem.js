import{_ as O}from"./Cpqrc0mm.js";import{d as $,a7 as R,u as j,a as q,L as D,r as w,j as L,t as o,x as t,z as r,S as p,P as g,U as y,Q as l,a8 as U,Z as m,$ as v,R as P,v as u,y as _,B as x,a9 as z}from"./DLcz0TMY.js";import{_ as A}from"./DXtMd_uJ.js";import{u as Q}from"./BUktjEZA.js";const Z={class:"background"},G={class:"header"},H={method:"post",action:""},J=["value"],K=["value"],W={key:0},X={class:"checkbox-list"},Y=["value"],ee=["value"],te={key:1},se={class:"checkbox-list"},le=["value"],ne=["onUpdate:modelValue"],ae={key:2},oe={class:"checkbox-list"},ue=["value"],ie=["onUpdate:modelValue"],re=["value"],de={class:"modal-buttons"},be=$({__name:"ModifyExpense",setup(pe){var B;const k=Q().user,S=R(),T=j();S.query.id;const{$bridge:C}=q(),b=C;b.setjwt(D("token").value??"");const f=new Date,h=k.colocationId,I=k.id,d=w([]),N=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],s=w({colocationId:h,createdBy:"",description:"",category:"",name:"",amount:0,paidBy:((B=d.value[0])==null?void 0:B.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:f.toISOString()});b.getUserbyCollocId(h).then(a=>{var n;d.value=a,Object.assign(s.value,{colocationId:h,createdBy:I,description:"",category:name,name:"",amount:0,paidBy:((n=d.value[0])==null?void 0:n.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:f.toISOString()})}).catch(a=>{console.error("Error fetching data:",a)});const E=a=>((s.value.splitPercentages[a]||0)/100*s.value.amount).toFixed(2),F=L(()=>{const a=s.value.splitBetween.length;return a>0?(s.value.amount/a).toFixed(2):0}),V=async()=>{console.log(s.value),b.addExpense(s.value).then(()=>{console.log("Expense added successfully"),T.back()}).catch(a=>{console.error("Error adding expense:",a)})},M=a=>{const n=a.target,i=n.value,e=i.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");e!==i&&(n.value=e),isNaN(parseFloat(e))?s.value.amount=0:s.value.amount=parseFloat(e)};return(a,n)=>{const i=O;return u(),o("div",Z,[t("div",null,[t("h1",G,[t("img",{src:A,alt:"Return",width:"30",height:"30",onClick:n[0]||(n[0]=e=>a.$router.back())}),r(i,{source:"header_modify_expense"}),n[6]||(n[6]=t("p",null,null,-1))])]),t("form",H,[t("div",null,[t("h3",null,[r(i,{source:"expense_name"})]),p(t("input",{class:"body-input",rows:"3","onUpdate:modelValue":n[1]||(n[1]=e=>l(s).name=e),required:""},null,512),[[y,l(s).name]]),t("h3",null,[r(i,{source:"expense_amount"})]),p(t("input",{class:"body-input",type:"number","onUpdate:modelValue":n[2]||(n[2]=e=>l(s).amount=e),placeholder:"0.00",onInput:M,min:"0",required:""},null,544),[[y,l(s).amount]]),t("h3",null,[r(i,{source:"expense_paid_by"})]),p(t("select",{"onUpdate:modelValue":n[3]||(n[3]=e=>l(s).paidBy=e),class:"body-input"},[(u(!0),o(m,null,v(l(d),e=>(u(),o("option",{key:e.id,value:e.id},_(e.username),9,J))),128))],512),[[U,l(s).paidBy]]),t("h3",null,[r(i,{source:"split_type"})]),p(t("select",{"onUpdate:modelValue":n[4]||(n[4]=e=>l(s).splitType=e),class:"body-input"},[(u(),o(m,null,v(N,e=>t("option",{key:e.value,value:e.value},[r(i,{source:e.label},null,8,["source"])],8,K)),64))],512),[[U,l(s).splitType]]),l(s).splitType==0?(u(),o("div",W,[t("div",X,[(u(!0),o(m,null,v(l(d),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[p(t("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":n[5]||(n[5]=c=>l(s).splitBetween=c)},null,8,Y),[[z,l(s).splitBetween]]),x(" "+_(e.username)+" ",1),t("input",{type:"number",class:"split-value-input",value:l(s).splitBetween.includes(e.id)?l(F):0,readonly:""},null,8,ee)]))),128))])])):g("",!0),l(s).splitType==1?(u(),o("div",te,[t("div",se,[(u(!0),o(m,null,v(l(d),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[t("input",{type:"checkbox",value:e.id},null,8,le),x(" "+_(e.username)+" ",1),p(t("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>l(s).splitValues[e.id]=c,placeholder:"0.00",min:"0"},null,8,ne),[[y,l(s).splitValues[e.id],void 0,{number:!0}]])]))),128))])])):g("",!0),l(s).splitType==2?(u(),o("div",ae,[t("div",oe,[(u(!0),o(m,null,v(l(d),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[t("input",{type:"checkbox",value:e.id},null,8,ue),x(" "+_(e.username)+" ",1),p(t("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>l(s).splitPercentages[e.id]=c,placeholder:"0",min:"0",max:"100"},null,8,ie),[[y,l(s).splitPercentages[e.id],void 0,{number:!0}]]),t("input",{type:"number",class:"split-value-input",value:E(e.id),readonly:""},null,8,re)]))),128))])])):g("",!0)]),t("div",de,[t("button",{class:"button button-proceed",onClick:P(V,["prevent"])},[r(i,{source:"modify"})]),t("button",{class:"button button-proceed",onClick:P(V,["prevent"])},[r(i,{source:"delete"})])])])])}}});export{be as default};
