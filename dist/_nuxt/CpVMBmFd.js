import{_ as M}from"./CPblPPHw.js";import{d as O,J as $,a3 as j,h as D,j as R,K as A,r as w,c as L,a as o,b as u,E as t,G as p,L as d,Q as k,I as m,M as y,u as l,a4 as E,V as v,X as _,F as b,a5 as z,N as G,_ as H}from"./BX9cP-eP.js";import{_ as J}from"./D91_F98N.js";import{u as K}from"./DlNvyLd_.js";const Q={class:"background"},X={class:"header"},W={class:"form-container",method:"post",action:""},Y={class:"name-expense-container"},Z={class:"expense-container"},ee={class:"subtext"},te=["value"],se={class:"subtext"},ne=["value"],le={key:0},ae={class:"checkbox-list"},oe=["value"],ue=["value"],ie={key:1},re={class:"checkbox-list"},de=["value"],pe=["onUpdate:modelValue"],ce={key:2},me={class:"checkbox-list"},ve=["value"],_e={class:"split-value-container"},ye=["onUpdate:modelValue"],be=["value"],ge={class:"modal-buttons"},xe=O({__name:"addExpense",setup(he){var I;K({bodyAttrs:{style:"background-color: #1E1E1E;"}});const f=$().user,g=j(),T=D(),V=g.query.name,{$bridge:U}=R(),x=U;x.setjwt(A("token").value??"");const B=new Date,h=f.colocationId,P=f.id,r=w([]),S=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],n=w({colocationId:h,expenseCategoryId:g.query.categoryId,createdBy:"",name:"",description:"",amount:0,category:V,paidBy:((I=r.value[0])==null?void 0:I.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:B.toISOString()});x.getUserbyCollocId(h).then(a=>{var s;r.value=a,Object.assign(n.value,{colocationId:h,expenseCategoryId:g.query.categoryId,createdBy:P,description:"",category:V,name:"",amount:0,paidBy:((s=r.value[0])==null?void 0:s.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:B.toISOString()})}).catch(a=>{console.error("Error fetching data:",a)});const C=a=>((n.value.splitPercentages[a]||0)/100*n.value.amount).toFixed(2),N=L(()=>{const a=n.value.splitBetween.length;return a>0?(n.value.amount/a).toFixed(2):0}),F=async()=>{console.log(n.value),x.addExpense(n.value).then(a=>{a===!0&&(console.log("Expense added successfully!"),T.back())}).catch(a=>{console.error("Error adding expense:",a)})},q=a=>{const s=a.target,i=s.value,e=i.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");e!==i&&(s.value=e),isNaN(parseFloat(e))?n.value.amount=0:n.value.amount=parseFloat(e)};return(a,s)=>{const i=M;return u(),o("div",Q,[t("div",null,[t("h1",X,[t("img",{src:J,alt:"Return",width:"30",height:"30",onClick:s[0]||(s[0]=e=>a.$router.back())}),p(i,{source:"header_add_expense"}),s[6]||(s[6]=t("p",null,null,-1))])]),t("form",W,[t("div",null,[t("h3",null,[p(i,{source:"expense_name"}),s[7]||(s[7]=m(" : "))]),t("div",Y,[d(t("input",{class:"name-input",maxlength:"40","onUpdate:modelValue":s[1]||(s[1]=e=>l(n).name=e),required:""},null,512),[[y,l(n).name]]),t("div",Z,[d(t("input",{class:"expense-input",type:"number","onUpdate:modelValue":s[2]||(s[2]=e=>l(n).amount=e),onInput:q,min:"0",required:""},null,544),[[y,l(n).amount]]),s[8]||(s[8]=t("text",null,"â‚¬",-1))])]),t("h3",ee,[p(i,{source:"expense_paid_by"}),s[9]||(s[9]=m(" : "))]),d(t("select",{"onUpdate:modelValue":s[3]||(s[3]=e=>l(n).paidBy=e),class:"drop-down-input"},[(u(!0),o(v,null,_(l(r),e=>(u(),o("option",{key:e.id,value:e.id},b(e.username),9,te))),128))],512),[[E,l(n).paidBy]]),t("h3",se,[p(i,{source:"split_type"})]),d(t("select",{"onUpdate:modelValue":s[4]||(s[4]=e=>l(n).splitType=e),class:"drop-down-input"},[(u(),o(v,null,_(S,e=>t("option",{key:e.value,value:e.value},[p(i,{source:e.label},null,8,["source"])],8,ne)),64))],512),[[E,l(n).splitType]]),l(n).splitType==0?(u(),o("div",le,[t("div",ae,[(u(!0),o(v,null,_(l(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[d(t("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":s[5]||(s[5]=c=>l(n).splitBetween=c)},null,8,oe),[[z,l(n).splitBetween]]),m(" "+b(e.username)+" ",1),t("input",{type:"number",class:"split-value-input",value:l(n).splitBetween.includes(e.id)?l(N):0,readonly:""},null,8,ue)]))),128))])])):k("",!0),l(n).splitType==1?(u(),o("div",ie,[t("div",re,[(u(!0),o(v,null,_(l(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[t("input",{type:"checkbox",value:e.id},null,8,de),m(" "+b(e.username)+" ",1),d(t("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>l(n).splitValues[e.id]=c,placeholder:"0.00",min:"0"},null,8,pe),[[y,l(n).splitValues[e.id],void 0,{number:!0}]])]))),128))])])):k("",!0),l(n).splitType==2?(u(),o("div",ce,[t("div",me,[(u(!0),o(v,null,_(l(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item-pourcentage"},[t("input",{class:"check-zone",type:"checkbox",value:e.id},null,8,ve),m(" "+b(e.username)+" ",1),t("div",_e,[d(t("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>l(n).splitPercentages[e.id]=c,placeholder:"0",min:"0",max:"100"},null,8,ye),[[y,l(n).splitPercentages[e.id],void 0,{number:!0}]]),s[10]||(s[10]=t("span",{class:"percentage-symbol"},"%",-1))]),t("input",{type:"number",class:"split-value-input",value:C(e.id),readonly:""},null,8,be)]))),128))])])):k("",!0)]),t("div",ge,[t("button",{class:"button button-proceed",onClick:G(F,["prevent"])},[p(i,{source:"poster"})])])])])}}}),we=H(xe,[["__scopeId","data-v-8bfc6dee"]]);export{we as default};
