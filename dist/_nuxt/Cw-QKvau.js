import{_ as q}from"./CPblPPHw.js";import{_ as R}from"./DvChY-Ge.js";import{d as A,S as L,J as G,a3 as H,h as J,j as K,K as Q,r as B,c as X,a as i,b as a,E as n,P as z,Q as b,G as r,L as d,M as x,u as l,a4 as P,V as m,X as y,F as f,I as w,a5 as W,N as S,_ as Y}from"./BX9cP-eP.js";import{_ as Z}from"./D91_F98N.js";import{u as ee}from"./DlNvyLd_.js";const te={class:"background"},se={class:"header"},ne={class:"form-container",method:"post",action:""},le={class:"name-expense-container"},oe={class:"expense-container"},ae={class:"subtext"},ie=["value"],ue={class:"subtext"},pe=["value"],re={key:0},de={class:"checkbox-list"},ce=["value"],me=["value"],ve={key:1},_e={class:"checkbox-list"},ye=["value"],be=["onUpdate:modelValue"],xe={key:2},fe={class:"checkbox-list"},ge=["value"],he=["onUpdate:modelValue"],ke=["value"],Ve={class:"modal-buttons"},Be=A({__name:"ModifyExpense",setup(we){var E;ee({bodyAttrs:{style:"background-color: #1E1E1E;"}});const{t:Ie}=L(),I=G().user,U=H(),T=J(),g=U.query.id,{$bridge:N}=K(),v=N;v.setjwt(Q("token").value??"");const h=new Date,k=B(!1),V=I.colocationId;I.id;const p=B([]),O=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],s=B({id:g,colocationId:V,expenseCategoryId:"",description:"",name:"",amount:0,paidBy:((E=p.value[0])==null?void 0:E.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:h.toISOString()});v.getUserbyCollocId(V).then(o=>{var e;p.value=o,Object.assign(s.value,{colocationId:V,expenseCategoryId:"",description:"",name:"",amount:0,paidBy:((e=p.value[0])==null?void 0:e.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:h.toISOString()})}).catch(o=>{console.error("Error fetching data:",o)}),v.getExpenseById(g).then(o=>{const e=o;Object.assign(s.value,{id:e.id,expenseCategoryId:e.expenseCategoryId,description:e.description,name:e.name,amount:e.amount,paidBy:e.paidBy,splitType:e.splitType,dateOfPayment:h.toISOString()}),e.splitType===0?s.value.splitBetween=Object.keys(e.splitBetween):e.splitType===1?s.value.splitValues=e.splitBetween:e.splitType===2&&(s.value.splitPercentages=e.splitBetween)}).catch(o=>{console.error("Error fetching data:",o)});const F=o=>((s.value.splitPercentages[o]||0)/100*s.value.amount).toFixed(2),M=X(()=>{const o=s.value.splitBetween.length;return o>0?(s.value.amount/o).toFixed(2):0}),$=()=>{k.value=!0},j=()=>{k.value=!1},C=async o=>{o==="modify"?(console.log(s.value),await v.updateExpense(s.value)?(console.log("Expense modified successfully"),T.back()):console.error("Error modifying expense")):o==="delete"&&(await v.deleteExpense(g),T.back())},D=o=>{const e=o.target,u=e.value,c=u.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");c!==u&&(e.value=c),isNaN(parseFloat(c))?s.value.amount=0:s.value.amount=parseFloat(c)};return(o,e)=>{const u=q,c=R;return a(),i(m,null,[n("div",te,[n("div",null,[n("h1",se,[n("img",{src:Z,alt:"Return",width:"30",height:"30",onClick:e[0]||(e[0]=t=>o.$router.back())}),r(u,{source:"header_modify_expense"}),e[8]||(e[8]=n("p",null,null,-1))])]),n("form",ne,[n("div",null,[n("h3",null,[r(u,{source:"expense_name"})]),n("div",le,[d(n("input",{class:"name-input",maxlength:"40","onUpdate:modelValue":e[1]||(e[1]=t=>l(s).name=t),required:""},null,512),[[x,l(s).name]]),n("div",oe,[d(n("input",{class:"expense-input",type:"number","onUpdate:modelValue":e[2]||(e[2]=t=>l(s).amount=t),placeholder:"0.00",onInput:D,min:"0",required:""},null,544),[[x,l(s).amount]]),e[9]||(e[9]=n("text",null,"â‚¬",-1))])]),n("h3",ae,[r(u,{source:"expense_paid_by"})]),d(n("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>l(s).paidBy=t),class:"drop-down-input"},[(a(!0),i(m,null,y(l(p),t=>(a(),i("option",{key:t.id,value:t.id},f(t.username),9,ie))),128))],512),[[P,l(s).paidBy]]),n("h3",ue,[r(u,{source:"split_type"})]),d(n("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>l(s).splitType=t),class:"drop-down-input"},[(a(),i(m,null,y(O,t=>n("option",{key:t.value,value:t.value},[r(u,{source:t.label},null,8,["source"])],8,pe)),64))],512),[[P,l(s).splitType]]),l(s).splitType==0?(a(),i("div",re,[n("div",de,[(a(!0),i(m,null,y(l(p),t=>(a(),i("label",{key:t.id,class:"checkbox-item"},[d(n("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[5]||(e[5]=_=>l(s).splitBetween=_)},null,8,ce),[[W,l(s).splitBetween]]),w(" "+f(t.username)+" ",1),n("input",{type:"number",class:"split-value-input",value:l(s).splitBetween.includes(t.id)?l(M):0,readonly:""},null,8,me)]))),128))])])):b("",!0),l(s).splitType==1?(a(),i("div",ve,[n("div",_e,[(a(!0),i(m,null,y(l(p),t=>(a(),i("label",{key:t.id,class:"checkbox-item"},[n("input",{type:"checkbox",value:t.id},null,8,ye),w(" "+f(t.username)+" ",1),d(n("input",{type:"number",class:"split-value-input","onUpdate:modelValue":_=>l(s).splitValues[t.id]=_,placeholder:"0.00",min:"0"},null,8,be),[[x,l(s).splitValues[t.id],void 0,{number:!0}]])]))),128))])])):b("",!0),l(s).splitType==2?(a(),i("div",xe,[n("div",fe,[(a(!0),i(m,null,y(l(p),t=>(a(),i("label",{key:t.id,class:"checkbox-item-pourcentage"},[n("input",{type:"checkbox",value:t.id},null,8,ge),w(" "+f(t.username)+" ",1),d(n("input",{type:"number",class:"split-value-input","onUpdate:modelValue":_=>l(s).splitPercentages[t.id]=_,placeholder:"0",min:"0",max:"100"},null,8,he),[[x,l(s).splitPercentages[t.id],void 0,{number:!0}]]),n("input",{type:"number",class:"split-value-input",value:F(t.id),readonly:""},null,8,ke)]))),128))])])):b("",!0)]),n("div",Ve,[n("button",{class:"button button-proceed",onClick:e[6]||(e[6]=S(t=>C("modify"),["prevent"]))},[r(u,{source:"modify"})]),n("button",{class:"button button-proceed",onClick:S($,["prevent"])},[r(u,{source:"delete"})])])])]),l(k)?(a(),z(c,{key:0,text:o.$t("confirm_delete_expense"),onConfirm:e[7]||(e[7]=t=>C("delete")),onClose:j},null,8,["text"])):b("",!0)],64)}}}),Ne=Y(Be,[["__scopeId","data-v-175dbb5c"]]);export{Ne as default};
