import{_ as M}from"./DDPJLRn1.js";import{d as D,a8 as q,a5 as R,h as A,j as G,P as L,r as T,c as W,a as o,E as n,G as r,V as d,S as x,W as _,u as l,a6 as C,$ as y,a0 as v,U as P,b as i,F as b,I as k,a7 as z}from"./5LWRTrmI.js";import{_ as H}from"./D5QMMH-8.js";import{u as J}from"./Bbc-UTeH.js";const K={class:"background"},Q={class:"header"},X={method:"post",action:""},Y=["value"],Z=["value"],ee={key:0},te={class:"checkbox-list"},se=["value"],ne=["value"],le={key:1},ae={class:"checkbox-list"},oe=["value"],ie=["onUpdate:modelValue"],ue={key:2},re={class:"checkbox-list"},pe=["value"],de=["onUpdate:modelValue"],ce=["value"],me={class:"modal-buttons"},he=D({__name:"ModifyExpense",setup(ye){var I;const{t:S}=q(),B=J().user,U=R(),V=A(),g=U.query.id,{$bridge:E}=G(),c=E;c.setjwt(L("token").value??"");const f=new Date,h=B.colocationId,N=B.id,p=T([]),O=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],s=T({id:g,colocationId:h,expenseCategoryId:"",description:"",category:"",name:"",amount:0,paidBy:((I=p.value[0])==null?void 0:I.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:f.toISOString()});c.getUserbyCollocId(h).then(a=>{var e;p.value=a,Object.assign(s.value,{colocationId:h,expenseCategoryId:"",createdBy:N,description:"",category:"",name:"",amount:0,paidBy:((e=p.value[0])==null?void 0:e.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:f.toISOString()})}).catch(a=>{console.error("Error fetching data:",a)}),c.getExpenseById(g).then(a=>{const e=a;Object.assign(s.value,{id:e.id,expenseCategoryId:e.expenseCategoryId,createdBy:e.createdBy,description:e.description,category:e.expenseCategoryName,name:e.name,amount:e.amount,paidBy:e.paidBy,splitType:e.splitType,dateOfPayment:f.toISOString()}),e.splitType===0?s.value.splitBetween=Object.keys(e.splitBetween):e.splitType===1?s.value.splitValues=e.splitBetween:e.splitType===2&&(s.value.splitPercentages=e.splitBetween)}).catch(a=>{console.error("Error fetching data:",a)});const F=a=>((s.value.splitPercentages[a]||0)/100*s.value.amount).toFixed(2),$=W(()=>{const a=s.value.splitBetween.length;return a>0?(s.value.amount/a).toFixed(2):0}),w=async a=>{a==="modify"?(console.log(s.value),await c.updateExpense(s.value)?(console.log("Expense modified successfully"),V.back()):console.error("Error modifying expense")):a==="delete"&&window.confirm(S("confirm_delete_expense"))&&(await c.deleteExpense(g),V.back())},j=a=>{const e=a.target,u=e.value,t=u.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");t!==u&&(e.value=t),isNaN(parseFloat(t))?s.value.amount=0:s.value.amount=parseFloat(t)};return(a,e)=>{const u=M;return i(),o("div",K,[n("div",null,[n("h1",Q,[n("img",{src:H,alt:"Return",width:"30",height:"30",onClick:e[0]||(e[0]=t=>a.$router.back())}),r(u,{source:"header_modify_expense"}),e[8]||(e[8]=n("p",null,null,-1))])]),n("form",X,[n("div",null,[n("h3",null,[r(u,{source:"expense_name"})]),d(n("input",{class:"body-input",rows:"3","onUpdate:modelValue":e[1]||(e[1]=t=>l(s).name=t),required:""},null,512),[[_,l(s).name]]),n("h3",null,[r(u,{source:"expense_amount"})]),d(n("input",{class:"body-input",type:"number","onUpdate:modelValue":e[2]||(e[2]=t=>l(s).amount=t),placeholder:"0.00",onInput:j,min:"0",required:""},null,544),[[_,l(s).amount]]),n("h3",null,[r(u,{source:"expense_paid_by"})]),d(n("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>l(s).paidBy=t),class:"body-input"},[(i(!0),o(y,null,v(l(p),t=>(i(),o("option",{key:t.id,value:t.id},b(t.username),9,Y))),128))],512),[[C,l(s).paidBy]]),n("h3",null,[r(u,{source:"split_type"})]),d(n("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>l(s).splitType=t),class:"body-input"},[(i(),o(y,null,v(O,t=>n("option",{key:t.value,value:t.value},[r(u,{source:t.label},null,8,["source"])],8,Z)),64))],512),[[C,l(s).splitType]]),l(s).splitType==0?(i(),o("div",ee,[n("div",te,[(i(!0),o(y,null,v(l(p),t=>(i(),o("label",{key:t.id,class:"checkbox-item"},[d(n("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[5]||(e[5]=m=>l(s).splitBetween=m)},null,8,se),[[z,l(s).splitBetween]]),k(" "+b(t.username)+" ",1),n("input",{type:"number",class:"split-value-input",value:l(s).splitBetween.includes(t.id)?l($):0,readonly:""},null,8,ne)]))),128))])])):x("",!0),l(s).splitType==1?(i(),o("div",le,[n("div",ae,[(i(!0),o(y,null,v(l(p),t=>(i(),o("label",{key:t.id,class:"checkbox-item"},[n("input",{type:"checkbox",value:t.id},null,8,oe),k(" "+b(t.username)+" ",1),d(n("input",{type:"number",class:"split-value-input","onUpdate:modelValue":m=>l(s).splitValues[t.id]=m,placeholder:"0.00",min:"0"},null,8,ie),[[_,l(s).splitValues[t.id],void 0,{number:!0}]])]))),128))])])):x("",!0),l(s).splitType==2?(i(),o("div",ue,[n("div",re,[(i(!0),o(y,null,v(l(p),t=>(i(),o("label",{key:t.id,class:"checkbox-item"},[n("input",{type:"checkbox",value:t.id},null,8,pe),k(" "+b(t.username)+" ",1),d(n("input",{type:"number",class:"split-value-input","onUpdate:modelValue":m=>l(s).splitPercentages[t.id]=m,placeholder:"0",min:"0",max:"100"},null,8,de),[[_,l(s).splitPercentages[t.id],void 0,{number:!0}]]),n("input",{type:"number",class:"split-value-input",value:F(t.id),readonly:""},null,8,ce)]))),128))])])):x("",!0)]),n("div",me,[n("button",{class:"button button-proceed",onClick:e[6]||(e[6]=P(t=>w("modify"),["prevent"]))},[r(u,{source:"modify"})]),n("button",{class:"button button-proceed",onClick:e[7]||(e[7]=P(t=>w("delete"),["prevent"]))},[r(u,{source:"delete"})])])])])}}});export{he as default};
