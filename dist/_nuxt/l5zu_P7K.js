import{_ as O}from"./DDPJLRn1.js";import{d as $,a5 as M,h as j,j as D,P as R,r as w,c as A,a as o,E as s,G as d,V as p,S as x,W as v,u as n,a6 as U,$ as m,a0 as _,U as G,b as u,F as y,I as k,a7 as L,_ as W}from"./5LWRTrmI.js";import{_ as z}from"./D5QMMH-8.js";import{u as H}from"./Bbc-UTeH.js";const J={class:"background"},K={class:"header"},Q={method:"post",action:""},X=["value"],Y=["value"],Z={key:0},ee={class:"checkbox-list"},te=["value"],se=["value"],ne={key:1},le={class:"checkbox-list"},ae=["value"],oe=["onUpdate:modelValue"],ue={key:2},ie={class:"checkbox-list"},re=["value"],de=["onUpdate:modelValue"],pe=["value"],ce={class:"modal-buttons"},me=$({__name:"addExpense",setup(_e){var I;const f=H().user,b=M(),P=j(),V=b.query.name,{$bridge:S}=D(),h=S;h.setjwt(R("token").value??"");const B=new Date,g=f.colocationId,T=f.id,r=w([]),C=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],t=w({colocationId:g,expenseCategoryId:b.query.categoryId,createdBy:"",name:"",description:"",amount:0,category:V,paidBy:((I=r.value[0])==null?void 0:I.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:B.toISOString()});h.getUserbyCollocId(g).then(a=>{var l;r.value=a,Object.assign(t.value,{colocationId:g,expenseCategoryId:b.query.categoryId,createdBy:T,description:"",category:V,name:"",amount:0,paidBy:((l=r.value[0])==null?void 0:l.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:B.toISOString()})}).catch(a=>{console.error("Error fetching data:",a)});const E=a=>((t.value.splitPercentages[a]||0)/100*t.value.amount).toFixed(2),N=A(()=>{const a=t.value.splitBetween.length;return a>0?(t.value.amount/a).toFixed(2):0}),F=async()=>{console.log(t.value),h.addExpense(t.value).then(()=>{console.log("Expense added successfully"),P.back()}).catch(a=>{console.error("Error adding expense:",a)})},q=a=>{const l=a.target,i=l.value,e=i.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");e!==i&&(l.value=e),isNaN(parseFloat(e))?t.value.amount=0:t.value.amount=parseFloat(e)};return(a,l)=>{const i=O;return u(),o("div",J,[s("div",null,[s("h1",K,[s("img",{src:z,alt:"Return",width:"30",height:"30",onClick:l[0]||(l[0]=e=>a.$router.back())}),d(i,{source:"header_add_expense"}),l[6]||(l[6]=s("p",null,null,-1))])]),s("form",Q,[s("div",null,[s("h3",null,[d(i,{source:"expense_name"})]),p(s("input",{class:"body-input",rows:"3","onUpdate:modelValue":l[1]||(l[1]=e=>n(t).name=e),required:""},null,512),[[v,n(t).name]]),s("h3",null,[d(i,{source:"expense_amount"})]),p(s("input",{class:"body-input",type:"number","onUpdate:modelValue":l[2]||(l[2]=e=>n(t).amount=e),placeholder:"0.00",onInput:q,min:"0",required:""},null,544),[[v,n(t).amount]]),s("h3",null,[d(i,{source:"expense_paid_by"})]),p(s("select",{"onUpdate:modelValue":l[3]||(l[3]=e=>n(t).paidBy=e),class:"body-input"},[(u(!0),o(m,null,_(n(r),e=>(u(),o("option",{key:e.id,value:e.id},y(e.username),9,X))),128))],512),[[U,n(t).paidBy]]),s("h3",null,[d(i,{source:"split_type"})]),p(s("select",{"onUpdate:modelValue":l[4]||(l[4]=e=>n(t).splitType=e),class:"body-input"},[(u(),o(m,null,_(C,e=>s("option",{key:e.value,value:e.value},[d(i,{source:e.label},null,8,["source"])],8,Y)),64))],512),[[U,n(t).splitType]]),n(t).splitType==0?(u(),o("div",Z,[s("div",ee,[(u(!0),o(m,null,_(n(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[p(s("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":l[5]||(l[5]=c=>n(t).splitBetween=c)},null,8,te),[[L,n(t).splitBetween]]),k(" "+y(e.username)+" ",1),s("input",{type:"number",class:"split-value-input",value:n(t).splitBetween.includes(e.id)?n(N):0,readonly:""},null,8,se)]))),128))])])):x("",!0),n(t).splitType==1?(u(),o("div",ne,[s("div",le,[(u(!0),o(m,null,_(n(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[s("input",{type:"checkbox",value:e.id},null,8,ae),k(" "+y(e.username)+" ",1),p(s("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>n(t).splitValues[e.id]=c,placeholder:"0.00",min:"0"},null,8,oe),[[v,n(t).splitValues[e.id],void 0,{number:!0}]])]))),128))])])):x("",!0),n(t).splitType==2?(u(),o("div",ue,[s("div",ie,[(u(!0),o(m,null,_(n(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[s("input",{type:"checkbox",value:e.id},null,8,re),k(" "+y(e.username)+" ",1),p(s("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>n(t).splitPercentages[e.id]=c,placeholder:"0",min:"0",max:"100"},null,8,de),[[v,n(t).splitPercentages[e.id],void 0,{number:!0}]]),s("input",{type:"number",class:"split-value-input",value:E(e.id),readonly:""},null,8,pe)]))),128))])])):x("",!0)]),s("div",ce,[s("button",{class:"button button-proceed",onClick:G(F,["prevent"])},[d(i,{source:"poster"})])])])])}}}),xe=W(me,[["__scopeId","data-v-918f474d"]]);export{xe as default};
