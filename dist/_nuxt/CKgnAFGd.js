import{_ as q}from"./Dirlivie.js";import{d as $,O as M,a5 as R,h as j,j as D,P as z,r as w,c as A,a as o,b as u,E as t,G as p,Q as d,V as k,I as m,R as y,u as a,a6 as P,$ as _,a0 as v,F as b,a7 as G,S as L,_ as Q}from"./Ki-fkkP3.js";import{_ as H}from"./BOXG3y_H.js";const J={class:"background"},K={class:"header"},W={class:"form-container",method:"post",action:""},X={class:"name-expense-container"},Y={class:"expense-container"},Z={class:"subtext"},ee=["value"],te={class:"subtext"},se=["value"],ne={key:0},ae={class:"checkbox-list"},le=["value"],oe=["value"],ue={key:1},ie={class:"checkbox-list"},re=["value"],de=["onUpdate:modelValue"],pe={key:2},ce={class:"checkbox-list"},me=["value"],_e=["onUpdate:modelValue"],ve=["value"],ye={class:"modal-buttons"},be=$({__name:"addExpense",setup(he){var I;const f=M().user,h=R(),S=j(),V=h.query.name,{$bridge:T}=D(),x=T;x.setjwt(z("token").value??"");const B=new Date,g=f.colocationId,U=f.id,r=w([]),C=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],s=w({colocationId:g,expenseCategoryId:h.query.categoryId,createdBy:"",name:"",description:"",amount:0,category:V,paidBy:((I=r.value[0])==null?void 0:I.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:B.toISOString()});x.getUserbyCollocId(g).then(l=>{var n;r.value=l,Object.assign(s.value,{colocationId:g,expenseCategoryId:h.query.categoryId,createdBy:U,description:"",category:V,name:"",amount:0,paidBy:((n=r.value[0])==null?void 0:n.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:B.toISOString()})}).catch(l=>{console.error("Error fetching data:",l)});const E=l=>((s.value.splitPercentages[l]||0)/100*s.value.amount).toFixed(2),N=A(()=>{const l=s.value.splitBetween.length;return l>0?(s.value.amount/l).toFixed(2):0}),F=async()=>{console.log(s.value),x.addExpense(s.value).then(()=>{console.log("Expense added successfully"),S.back()}).catch(l=>{console.error("Error adding expense:",l)})},O=l=>{const n=l.target,i=n.value,e=i.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");e!==i&&(n.value=e),isNaN(parseFloat(e))?s.value.amount=0:s.value.amount=parseFloat(e)};return(l,n)=>{const i=q;return u(),o("div",J,[t("div",null,[t("h1",K,[t("img",{src:H,alt:"Return",width:"30",height:"30",onClick:n[0]||(n[0]=e=>l.$router.back())}),p(i,{source:"header_add_expense"}),n[6]||(n[6]=t("p",null,null,-1))])]),t("form",W,[t("div",null,[t("h3",null,[p(i,{source:"expense_name"}),n[7]||(n[7]=m(" : "))]),t("div",X,[d(t("input",{class:"name-input",maxlength:"40","onUpdate:modelValue":n[1]||(n[1]=e=>a(s).name=e),required:""},null,512),[[y,a(s).name]]),t("div",Y,[d(t("input",{class:"expense-input",type:"number","onUpdate:modelValue":n[2]||(n[2]=e=>a(s).amount=e),onInput:O,min:"0",required:""},null,544),[[y,a(s).amount]]),n[8]||(n[8]=t("text",null,"â‚¬",-1))])]),t("h3",Z,[p(i,{source:"expense_paid_by"}),n[9]||(n[9]=m(" : "))]),d(t("select",{"onUpdate:modelValue":n[3]||(n[3]=e=>a(s).paidBy=e),class:"drop-down-input"},[(u(!0),o(_,null,v(a(r),e=>(u(),o("option",{key:e.id,value:e.id},b(e.username),9,ee))),128))],512),[[P,a(s).paidBy]]),t("h3",te,[p(i,{source:"split_type"})]),d(t("select",{"onUpdate:modelValue":n[4]||(n[4]=e=>a(s).splitType=e),class:"drop-down-input"},[(u(),o(_,null,v(C,e=>t("option",{key:e.value,value:e.value},[p(i,{source:e.label},null,8,["source"])],8,se)),64))],512),[[P,a(s).splitType]]),a(s).splitType==0?(u(),o("div",ne,[t("div",ae,[(u(!0),o(_,null,v(a(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[d(t("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":n[5]||(n[5]=c=>a(s).splitBetween=c)},null,8,le),[[G,a(s).splitBetween]]),m(" "+b(e.username)+" ",1),t("input",{type:"number",class:"split-value-input",value:a(s).splitBetween.includes(e.id)?a(N):0,readonly:""},null,8,oe)]))),128))])])):k("",!0),a(s).splitType==1?(u(),o("div",ue,[t("div",ie,[(u(!0),o(_,null,v(a(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item"},[t("input",{type:"checkbox",value:e.id},null,8,re),m(" "+b(e.username)+" ",1),d(t("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>a(s).splitValues[e.id]=c,placeholder:"0.00",min:"0"},null,8,de),[[y,a(s).splitValues[e.id],void 0,{number:!0}]])]))),128))])])):k("",!0),a(s).splitType==2?(u(),o("div",pe,[t("div",ce,[(u(!0),o(_,null,v(a(r),e=>(u(),o("label",{key:e.id,class:"checkbox-item-pourcentage"},[t("input",{class:"check-zone",type:"checkbox",value:e.id},null,8,me),m(" "+b(e.username)+" ",1),d(t("input",{type:"number",class:"split-value-input","onUpdate:modelValue":c=>a(s).splitPercentages[e.id]=c,placeholder:"0",min:"0",max:"100"},null,8,_e),[[y,a(s).splitPercentages[e.id],void 0,{number:!0}]]),t("input",{type:"number",class:"split-value-input",value:E(e.id),readonly:""},null,8,ve)]))),128))])])):k("",!0)]),t("div",ye,[t("button",{class:"button button-proceed",onClick:L(F,["prevent"])},[p(i,{source:"poster"})])])])])}}}),Ve=Q(be,[["__scopeId","data-v-ac728b9e"]]);export{Ve as default};
