import{_ as j}from"./KSohXE1L.js";import{d as D,a5 as q,J as R,a2 as A,h as L,j as G,K as H,r as T,c as J,a,b as i,E as n,G as d,L as p,Q as h,M as _,u as l,a3 as E,V as y,W as v,F as b,I as k,a4 as K,N as C,_ as Q}from"./DwWSAJDC.js";import{_ as W}from"./BixHH8iW.js";import{u as z}from"./CsgKcG8t.js";const X={class:"background"},Y={class:"header"},Z={class:"form-container",method:"post",action:""},ee={class:"name-expense-container"},te={class:"expense-container"},se={class:"subtext"},ne=["value"],le={class:"subtext"},oe=["value"],ae={key:0},ie={class:"checkbox-list"},ue=["value"],re=["value"],de={key:1},pe={class:"checkbox-list"},ce=["value"],me=["onUpdate:modelValue"],ye={key:2},ve={class:"checkbox-list"},_e=["value"],be=["onUpdate:modelValue"],fe=["value"],ge={class:"modal-buttons"},xe=D({__name:"ModifyExpense",setup(he){var I;z({bodyAttrs:{style:"background-color: #1E1E1E;"}});const{t:P}=q(),B=R().user,S=A(),V=L(),f=S.query.id,{$bridge:U}=G(),c=U;c.setjwt(H("token").value??"");const g=new Date,x=B.colocationId,N=B.id,r=T([]),O=[{value:0,label:"split_type0"},{value:1,label:"split_type1"},{value:2,label:"split_type2"}],s=T({id:f,colocationId:x,expenseCategoryId:"",description:"",category:"",name:"",amount:0,paidBy:((I=r.value[0])==null?void 0:I.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:g.toISOString()});c.getUserbyCollocId(x).then(o=>{var e;r.value=o,Object.assign(s.value,{colocationId:x,expenseCategoryId:"",createdBy:N,description:"",category:"",name:"",amount:0,paidBy:((e=r.value[0])==null?void 0:e.id)||"",splitType:0,splitBetween:[],splitValues:{},splitPercentages:{},dateOfPayment:g.toISOString()})}).catch(o=>{console.error("Error fetching data:",o)}),c.getExpenseById(f).then(o=>{const e=o;Object.assign(s.value,{id:e.id,expenseCategoryId:e.expenseCategoryId,createdBy:e.createdBy,description:e.description,category:e.expenseCategoryName,name:e.name,amount:e.amount,paidBy:e.paidBy,splitType:e.splitType,dateOfPayment:g.toISOString()}),e.splitType===0?s.value.splitBetween=Object.keys(e.splitBetween):e.splitType===1?s.value.splitValues=e.splitBetween:e.splitType===2&&(s.value.splitPercentages=e.splitBetween)}).catch(o=>{console.error("Error fetching data:",o)});const F=o=>((s.value.splitPercentages[o]||0)/100*s.value.amount).toFixed(2),M=J(()=>{const o=s.value.splitBetween.length;return o>0?(s.value.amount/o).toFixed(2):0}),w=async o=>{o==="modify"?(console.log(s.value),await c.updateExpense(s.value)?(console.log("Expense modified successfully"),V.back()):console.error("Error modifying expense")):o==="delete"&&window.confirm(P("confirm_delete_expense"))&&(await c.deleteExpense(f),V.back())},$=o=>{const e=o.target,u=e.value,t=u.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1");t!==u&&(e.value=t),isNaN(parseFloat(t))?s.value.amount=0:s.value.amount=parseFloat(t)};return(o,e)=>{const u=j;return i(),a("div",X,[n("div",null,[n("h1",Y,[n("img",{src:W,alt:"Return",width:"30",height:"30",onClick:e[0]||(e[0]=t=>o.$router.back())}),d(u,{source:"header_modify_expense"}),e[8]||(e[8]=n("p",null,null,-1))])]),n("form",Z,[n("div",null,[n("h3",null,[d(u,{source:"expense_name"})]),n("div",ee,[p(n("input",{class:"name-input",maxlength:"40","onUpdate:modelValue":e[1]||(e[1]=t=>l(s).name=t),required:""},null,512),[[_,l(s).name]]),n("div",te,[p(n("input",{class:"expense-input",type:"number","onUpdate:modelValue":e[2]||(e[2]=t=>l(s).amount=t),placeholder:"0.00",onInput:$,min:"0",required:""},null,544),[[_,l(s).amount]]),e[9]||(e[9]=n("text",null,"â‚¬",-1))])]),n("h3",se,[d(u,{source:"expense_paid_by"})]),p(n("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>l(s).paidBy=t),class:"drop-down-input"},[(i(!0),a(y,null,v(l(r),t=>(i(),a("option",{key:t.id,value:t.id},b(t.username),9,ne))),128))],512),[[E,l(s).paidBy]]),n("h3",le,[d(u,{source:"split_type"})]),p(n("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>l(s).splitType=t),class:"drop-down-input"},[(i(),a(y,null,v(O,t=>n("option",{key:t.value,value:t.value},[d(u,{source:t.label},null,8,["source"])],8,oe)),64))],512),[[E,l(s).splitType]]),l(s).splitType==0?(i(),a("div",ae,[n("div",ie,[(i(!0),a(y,null,v(l(r),t=>(i(),a("label",{key:t.id,class:"checkbox-item"},[p(n("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[5]||(e[5]=m=>l(s).splitBetween=m)},null,8,ue),[[K,l(s).splitBetween]]),k(" "+b(t.username)+" ",1),n("input",{type:"number",class:"split-value-input",value:l(s).splitBetween.includes(t.id)?l(M):0,readonly:""},null,8,re)]))),128))])])):h("",!0),l(s).splitType==1?(i(),a("div",de,[n("div",pe,[(i(!0),a(y,null,v(l(r),t=>(i(),a("label",{key:t.id,class:"checkbox-item"},[n("input",{type:"checkbox",value:t.id},null,8,ce),k(" "+b(t.username)+" ",1),p(n("input",{type:"number",class:"split-value-input","onUpdate:modelValue":m=>l(s).splitValues[t.id]=m,placeholder:"0.00",min:"0"},null,8,me),[[_,l(s).splitValues[t.id],void 0,{number:!0}]])]))),128))])])):h("",!0),l(s).splitType==2?(i(),a("div",ye,[n("div",ve,[(i(!0),a(y,null,v(l(r),t=>(i(),a("label",{key:t.id,class:"checkbox-item-pourcentage"},[n("input",{type:"checkbox",value:t.id},null,8,_e),k(" "+b(t.username)+" ",1),p(n("input",{type:"number",class:"split-value-input","onUpdate:modelValue":m=>l(s).splitPercentages[t.id]=m,placeholder:"0",min:"0",max:"100"},null,8,be),[[_,l(s).splitPercentages[t.id],void 0,{number:!0}]]),n("input",{type:"number",class:"split-value-input",value:F(t.id),readonly:""},null,8,fe)]))),128))])])):h("",!0)]),n("div",ge,[n("button",{class:"button button-proceed",onClick:e[6]||(e[6]=C(t=>w("modify"),["prevent"]))},[d(u,{source:"modify"})]),n("button",{class:"button button-proceed",onClick:e[7]||(e[7]=C(t=>w("delete"),["prevent"]))},[d(u,{source:"delete"})])])])])}}}),Te=Q(xe,[["__scopeId","data-v-178f2f40"]]);export{Te as default};
